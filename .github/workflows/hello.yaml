name: Deploy from dev repository
on:
    push:
        tags:
            - v*
    workflow_dispatch:

jobs:
    deploy-prod:
        name: deploy-prod
        runs-on: ubuntu-22.04
        steps:
            - name: Checkout prod repository
              uses: actions/checkout@v4
              with:
                path: actions-prac-dev
            - name: Checkout dev repository
              uses: actions/checkout@v4
              with:
                repository: utcarnivaldayo/actions-prac-prod
                path: actions-prac-prod
            - name: Install node
              uses: actions/setup-node@v4
              with:
                node-version: 20.10.0
            - name: Check node and npm version
              run: |
                node -v
                npm -v
            - name: Check node_modules and package-lock.json
              run: |
                cd actions-prac-dev
                test ! -d node_modules && echo "Error: node_modules does not exist !!!" && exit 1
                test ! -e package-lock.json && echo "Error: package-lock.json does not exist !!!" && exit 1
